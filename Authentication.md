# Authentication
#Authentication #Bruteforce #MFA #Password-Cracking 

Vulnerabilities in authentication mechanisms arise in one of two ways:

-   The authentication mechanisms are **weak** because they fail to adequately protect against **brute force** attacks.
-   Logic flaws or poor coding in the implementation allow the authentication mechanisms to be **bypassed** entirely by an attacker. This is sometimes referred to as "**broken authentication**".

In many areas of web development, **logic flaws** will simply cause the website to behave unexpectedly, which may or may not be a security issue. However, as authentication is so **critical** to security, the likelihood that flawed authentication logic exposes the website to security issues is clearly **elevated**.

## Password-Based Login Vulnerabilities
### Brute Force Attacks
#### Usernames
* Usernames are **easy** to guess if they conform to a recognisable **pattern** such as an email address. 
* High privileged accounts are often created using **standard** names such as `administrator` or `root`
* Check **error messages** for emails such as support or administrators. 

#### Passwords
* Is the **password policy** displayed on the `signup` page of the website?
* Common passwords usually begin with an **uppercase** character and end with a **number** or **special character**.
* Attempt **common** replacement such as replacing an `1` with an `!`.

### Username Enumeration
|Method|Explanation|
|---|---|
|Status Codes|The returned HTTP status code is likely to be the **same** for most of the guesses (as they will be incorrect). However, if a username returns a **different** status code it is likely correct|
|Error Messages|Depending on whether or not the username is correct, the application might return a **different error message**. For example if the user is **correct** the application might display `incorrect password for this user`. Whereas, if the user **does not** exist the message might be `No such user`.|
|Response Times|If the username is **correct**, the application will need to check whether or not the **password** is also correct. This may cause an **increase** in response time from the server.|
|Account Lockouts|By attempting a user account **multiple** times, you can potentially **lock** the account out. By doing so an error message may be returned indicating it is **locked**, hence confirming the user **exists**.||

### Flawed Brute Force Protection
The most common ways of preventing brute force attacks are:
* Locking the account the remote user is trying to access after too many failures.
* Blocking the remote user's IP address after too many incorrect login attempts.

Methods of evading these techniques include: 
* Changing your IP address on every request, for example, using the `X-Forwarded-For` header. 
* Successfully logging in every x amount of attempts to prevent lockouts.

## Multi-Factor Authentication Vulnerabilities
### Bypassing MFA
