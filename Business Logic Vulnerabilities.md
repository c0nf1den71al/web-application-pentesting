# Business Logic Vulnerabilities
#Business-Logic #MFA

Business logic vulnerabilities are flaws in the **design** and **implementation** of an application that allow an attacker to elicit **unintended** behaviour. This potentially enables attackers to **manipulate** legitimate functionality to achieve a malicious goal.

## Examples Of Business Logic Vulnerabilities
### Excessive Trust In Client-Side Controls
A flawed assumption is that users will **only** interact with the application via the **provided web interface**. This is especially dangerous because it leads to further assumption that client-side **validation** will prevent users from supplying malicious input.

Accepting data at face value, **without** performing proper integrity checks and server-side validation, can allow an attacker to do **high amounts** of damage.

### Failing To Handle Unconventional Input
**Application logic** is used to restrict user input to values that adhere to the business rules. For example, a user should not be able to **send** `-£100` to a user. If this was permitted, this may result in the attacker **receiving** `£100` from the user instead.

When auditing an application, you should use tools such as **Burp Proxy** and **Repeater** to try submitting **unconventional** values. In particular, try input in ranges that legitimate users are unlikely to ever enter. This includes exceptionally **high** or exceptionally **low** numeric inputs and abnormally long strings for text-based fields. You can even try **unexpected data types**.

### Making Flawed Assumptions About The User
One of the most common causes of business logic vulnerabilities is making **assumptions** about user behaviour. An example of this is assuming users will always supply values for **mandatory** input fields. 

Another example of flawed assumptions is assuming users will remain **trustworthy**. Some applications make the **mistake** assuming that, having passed **robust security controls** initially, the user and their data can be trusted indefinitely.

It is also important to never assume that users will follow the desired **flow** of a website. Users may **skip** a MFA authentication page for example, allowing the attacker to **authenticate** as a user.

### Domain-Specific Flaws
In many cases logic flaws are **specific** to the domain or the purpose of the site. A common example of a flaw is discount features on shops. If a discount is **only** applied on orders over `£100` an attacker can add **multiple** items until the discount is applied then **remove** the items.

### Providing An Encryption Oracle
Dangerous scenarios can occur when user-controllable input is **encrypted** and the resulting ciphertext is then **made available** to the user in some way. This kind of input is known as an **encryption oracle**.

This becomes **dangerous** when there are other user-controllable inputs in the application that expect data **encrypted** with the **same** algorithm. In this case, an attacker could potentially use the **encryption oracle** to generate **valid**, **encrypted** input and then pass it into other sensitive functions.