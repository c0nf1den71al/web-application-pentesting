# DOM-Based Vulnerabilities
#DOM #XSS 

DOM-based vulnerabilities arise when a website passes data from a [[DOM-Based Vulnerabilities#Sources|source]] to a [[DOM-Based Vulnerabilities#Sinks|sink]], which then handles the data in an **unsafe** way in the context of the client's **session**.

## Sources
A source is a JavaScript property that **accepts data** that is potentially **attacker-controlled**.

The following are common examples of sources which can be used to exploit a number of vulnerabilities:

* `document.URL`
* `document.documentURI`
* `document.URLUnencoded`
* `document.baseURI`
* `location`
* `document.cookie`
* `document.referrer`
* `window.name`
* `history.pushState`
* `history.replaceState`
* `localStorage`
* `sessionStorage`
* `IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)`
* `Database`

## Sinks
A sink is a potentially **dangerous** JavaScript function or DOM object that can cause **undesirable** effects if **attacker-controlled data** is passed to it. For example, the `eval()` function is a sink because it **processes** the argument that is **passed to** it as JavaScript. See the table below for a number of **DOM-based** vulnerabilities and an example of an associated **sink**:

|DOM-Based Vulnerability|Example Sink|
|---|---|
|[[Cross-Site Scripting (XSS)#DOM-Based \| DOM XSS]]|`docuent.write()`|
|Open Redirection|`window.location`|
|Cookie Manipulation|`document.cookie`|
|JavaScript injection|`eval()`|
|Document-domain manipulation|`document.domain`|
|[[WebSockets \| Websocket]]-URL poisoning|`WebSocket()``|
|Link manipulation|`element.src`|
|Web message manipulation|`postMessage()`|
|Ajax request-header manipulation|`setRequestHeader()`|
|Local file-path manipulation|`FileReader.readAsText()`|
|Client-side [[SQL injection]]|`ExecuteSql()`|
|HTML5-storage manipulation|`sessionStorage.setItem()`|
|Client-side XPath injection|`document.evaluate()`|
|Client-side JSON injection|`JSON.parse()`|
|DOM-data manipulation|`element.setAttribute()`|
|Denial of service|`RegExp()`|