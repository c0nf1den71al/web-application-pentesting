# File Upload Vulnerabilities
#Directory-Traveral #File-Upload #HTTP-Headers

File upload vulnerabilities are when a web server allows users to **upload** files to its filesystem **without** sufficiently validating things like their **name**, **type**, **contents**, or **size**. Failing to properly enforce restrictions on these could mean that even a basic image upload function can be used to upload arbitrary and potentially **dangerous** files instead. This could even include server-side script files that enable **remote code execution**.

## Exploiting Unrestricted File Uploads
Basic web shell:
```php
<?php echo system($_GET["c"]); ?>
```


## Bypassing File Upload Restrictions
### Content-Type Restrictions
When submitting **HTML** forms, the browser typically sends the provided data in a `POST` request with the content type `application/x-www-form-url-encoded`. This is fine for sending **simple text** like your name, address, and so on, but is not suitable for sending **large amounts** of binary data, such as an entire image file or a PDF document. In this case, the content type `multipart/form-data` is the preferred approach.

Burp repeater can be used to **bypass** this approach. Simply by changing the `Content-Type` to `image/png` for example.
![](Images/Pasted%20image%2020220824110718.png)

### Preventing File Execution in Upload Directories
Often the execution of files are prevented in upload directories by the server. This prevents any malicious code being executed.

However, often the user can manipulate the location where the file is uploaded using techniques such as [directory traversal](Directory%20Traversal.md)