# Directory Traversal
#Character-Encoding #Directory-Traveral

Directory traversal (also known as file path traversal) is a web security vulnerability that allows an attacker to **read arbitrary files** on the server that is running an application. This might include application **code** and data, **credentials** for back-end systems, and **sensitive** operating system files. In some cases, an attacker might be able to write to **arbitrary** files on the server, allowing them to modify **application** data or behaviour, and ultimately take **full control** of the server.

## Reading Arbitrary Files
Consider a shopping application that displays images of items for sale. Images are loaded via some **HTML** like the following:
`<img src="/loadImage?filename=218.png">`

The `loadImage` URL takes a `filename` parameter and returns the contents of the **specified file**. The image files themselves are stored on **disk** in the location `/var/www/images/`. To return an image, the application appends the requested filename to this base directory and uses a filesystem API to read the contents of the file. In the above case, the application reads from the following file path:
`/var/www/images/218.png`

The application implements no defences against directory traversal attacks, so an attacker can request the following URL to retrieve an arbitrary file from the server's filesystem:
`https://insecure-website.com/loadImage?filename=../../../etc/passwd`

This causes the application to read from the following file path:
`/var/www/images/../../../etc/passwd`

## Evading Input Filters/Sanitisation 
Many applications that place user input into file paths implement some kind of **defence** against path traversal attacks, and these can often be **circumvented**.

If an application **strips** or **blocks** directory traversal sequences from the user-supplied filename, then it might be possible to bypass the **defence** using a variety of techniques. 

|Technique|Example (../../../etc/passwd)|
|---|---|
|Nested Traveral|`....//....//....//etc/passwd` (`....\/` for Windows)|
|URL Encoding|`%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd`|
|Double URL Encoding|`%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd`|
|Start Of Path|`/var/www/images/../../../etc/passwd`|
|Null Byte Bypass|`../../../etc/passwd%00.png`|
