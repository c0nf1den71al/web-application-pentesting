# Identifying Attacks
Whilst its not recommended to follow a checklist, if you are really struggling, below is a list of points to help you identify attacks during a penetration test or exam.

## Access Control
1. Can the login form be bypassed? (Go straight to /admin)
2. If authenticated can you change the user ID or username?
3. Can you submit a sensitive request but change the Referer header to where the request was suppose to come from?


## Authentication
1. User enumeration 
	* Are different error messages returned for right/wrong usernames?
	* Are there different response codes for right/wrong usernames?
	* Are the response times different for right/wrong usernames?
2. Brute-force
	* Can you brute-force password/MFA?
	* Can you brute force the stay-logged-in cookie
	* Can you crack the password offline?
	* Change IP using headers to avoid IP blocking
	* Correctly authenticate every other attempt to prevent lock-outs.
3. Is basic authentication being used? base64(username:password)
4. Can you bypass MFA pages?
5. Can you reset the users password but change the user?
6. Can you poison the password reset?


## Business Logic
1. Can you change the data type on inputs? How is this handled?
2. Can you provide a really big/small/negative input? How is this handled?
3. Is an encryption oracle present (something outputting encrypted data?)


## Clickjacking
1. Are X-Frame-Options or CSP enabled?
2. Can it be used to trigger DOM XSS?
3. Is a frame busting script in use? Can this be bypassed?


## Cross-Origin Resource Sharing (CORS)
1. Can the Origin header be changed?
	* Try using `null`
	* Can you trick the header by changing the attacker url to extend the legitimate one? For example: `target.com.malicious.com`.
2. Is CORS in use?
3. Can you use CORS to access a Intranet


## Cross-Site Request Forgery (CSRF)
1. Is a CSRF token in use? Is it tied to the user session?
2. Try both POST and GET requests
3. Use burp to generate a POC


## Cross-Site Scripting (XSS)
1. Is anything present in the URL? Send this to victim
2. Blog post?
3. Attempt breaking out of input using tags, apostrophes, templates etc..
4. Utilise html attributes such as onclick and onerror.
5. Brute-force tags and attributes, what is allowed?
6. DOM Based - look for sinks and sources
7. Custom tags, canonical tags and onfocus


## Directory Traversal
1. Is a file specified in the request or a request made to fetch a file?
2. Try basic traversal (../../../../)
3. Try URL encoding and double URL encoding
4. Try absolute paths and null byte bypass


## DOM-Based Vulnerabilities
1. Identify sources and sinks
2. Use burp DOM invader
3. Websockets in use?
4. Web messages in use?


## File Upload Vulnerabilities
1. Is it possible to upload a file?
2. Can you upload PHP?
3. Change the `Content-Type` header
4. Try path traversal to upload to a different directory
5. Can you override the config file (`.htaccess`/`web.config`)?
6. Obfuscate the file extension
7. Change the magic numbers of the file
8. Try a polyglot upload


## HTTP Host Header Attacks
1. Can an arbitrary `Host` header be supplied?
2. Check for flawed validation of the header
3. Supply an absolute URL 
4. Inject multiple headers
5. Add line wrapping
6. Inject host override headers e.g. `X-Host`


## HTTP Request Smuggling
1. Are both the `Content-Length` and `Transfer-Encoding` headers in use?
2. Use the request smuggler burp plugin to try and find vulnerabilities
3. Can you obfuscate the `Transfer-Encoding` header to exploit TE.TE vulnerabilities?
4. Can you downgrade `HTTP/2` requests?
5. Can you capture other users requests?


## Information Disclosure
1. Try fuzzing for sensitive pages
	* Burp scanner
	* Dirb / DirBuster
2. Are `robots.txt` or `sitemap.xml` available?
3. Are their comments in the code?
4. Are debug pages enabled?
5. is `.git` present? Is information disclosed in past commits?
6. Are backup files present?


## Insecure Deserialization
1. Are serialized objects being used?
2. Can the object be changed directly
	* Change the values
	* Change the data types
3. Can you execute a website function?
4. Can you use magic methods?
5. Try using gadget chains
	* ysoserial
	* PHPGGC
	* Any documented gadget chains?


## JWT Attacks
1. Are JWT used for authorization on the website?
2. Can the JWT be changed and signature is not verified
3. Change the `alg` parameter to `none`
4. Can the secret be brute forced? [JWT wordlist](https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list)
5. Can you self-sign the JWT 
	* Using the `jwk` header?
	* Using the `jku` parameter?
	* Using path traversal in the `kid` parameter?


## OAuth Authentication
1. Is there an option to sign in using social media?
2. Is a redirect URI being used? 
3. Look for OAuth config files (see quick reference)
4. Can you intercept the requests and change the username?
5. Can you use CSRF to link your account with the victim's?
6. Try to hijack the `redirect_uri`.
7. Is it possible to steal codes or access tokens via open redirect?


## OS Command Injection
1. Try chaining a command using characters such as `&`
2. Detect blind attacks using time delays such as `ping`
3. Can you redirect blind output to a file?
4. Can you send a blind output via HTTP/DNS request?


## Server-Side Request Forgery
1. Do any parameters take a domain/URL? Can you use this to make a request to an internal host?
2. Fuzz for accessible pages e.g. `192.168.0.x`
3. Try bypassing input filters
4. Try open redirection to bypass filters


## Server-Side Template Injection
1. Try and raise an error by injecting payloads such as `${{<%[%'"}}%\`
2. Detect the templating language being used
3. Are there any documented/known exploits?
4. Try developer-supplied objects


## SQL Injection
1. Is SQL in use? Can you cause an error using characters such as `"` or `'`
2. Try to identify the DBMS using comments and basic queries.
3. Try to retrieve data
	* Basic `SELECT` statement
	* `UNION` statement
4. Get information regarding the DB
	* Version
	* DBs
	* Tables
	* Columns
5. Blind?
	* Can you use a cookie?
	* Time based?
	* Boolean based?
6. Can you exfiltrate data using DNS?


## Web Cache Poisoning
1. Use burp param miner to identify unkeyed inputs, headers, cookies etc..
2. Can you poison the cache to deliver XSS payloads
3. Try passing a parameter twice
4. Try parameter cloaking
5. Is it possible to send a fat `GET` request?


## WebSockets
1. Are WebSockets present on the site?
2. Can you intercept and modify the WebSocket messages?
3. Try using the WebSocket messages to send XSS payloads 


## XML External Entity Injection
1. Is XML being used?
2. Try and perform a SSRF attack
3. Can you include a file?
4. Is it possible in an image file upload?
5. Can you modify the content type of a request?
6. Try out-of-band exfiltration using requests.
7. Can you receive blind data through error messages?
8. Can you host a DTD file