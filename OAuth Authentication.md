# OAuth Authentication
#OAuth #SSRF 

Although not originally intended for this purpose, OAuth has evolved into a means of authenticating users. OAuth authentication is generally implemented as follows:

1. The user chooses the option to log in with their **social media** account. The client application then uses the social media site's OAuth service to **request** access to some data that it can use to identify the **user**. This could be the email address that is registered with their account, for example.
2. After receiving an **access token**, the client application requests this data from the **resource** server, typically from a dedicated `/userinfo` endpoint.
3. Once it has received the data, the client application uses it in place of a **username** to log the user in. The **access token** that it received from the authorization server is often used instead of a traditional **password**.

## Identifying OAuth Authentication
Recognising when an application uses OAuth authentication is fairly simple. Usually if an option to authenticate using **social media** is present then OAuth is likely in use. 

Another, more reliable, way to identify if OAuth is in use is to **proxy** the traffic to use burp. Regardless of which OAuth grant type is being used, the **first** request of the **flow** will always be a request to the `/authorization` **endpoint** containing a number of **parameters** such as `client_id`, `redirect_uri` and `response_type`.

An example OAuth authorisation request will look similar to this:
```Request
GET /authorization?client_id=12345&redirect_uri=https://client-app.com/callback&response_type=token&scope=openid%20profile&state=ae13d489bd00e3c24 HTTP/1.1
Host: oauth-authorization-server.com
```

Once the **hostname** of the **authorisation server** is known, it is worth sending a `GET` request to the following endpoints:
-   `/.well-known/oauth-authorization-server`
-   `/.well-known/openid-configuration`
These will often return a **JSON** configuration file containing **key information**, such as **details** of additional features that may be supported.

## Exploiting OAuth Authentication Vulnerabilities 
### Implicit Grant Types
The Implicit grant type is where the application receives the access token