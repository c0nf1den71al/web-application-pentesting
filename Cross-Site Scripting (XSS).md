# Cross-Site Scripting (XSS)
#XSS #DOM #AngularJS #Cookies

## Reflected
Reflected XSS is the simplest variety of cross-site scripting. It arises when an application receives data in an HTTP request and includes that data within the **immediate response** in an unsafe way.

An example of Reflected XSS is within a URI. For example: 
`https://insecure-website.com/status?message=<script>/*+Bad+stuff+here...+*/</script> <p>Status: <script>/* Bad stuff here... */</script></p>`

## Stored
Stored XSS (also known as persistent or second-order XSS) arises when an application receives data from an untrusted source and includes that data within its later HTTP responses in an unsafe way.

A **common** place where you might find Stored XSS is within a blog posts comments section. The contents of the comments could be:
`<p><script>/* Bad stuff here... */</script></p>` 

## DOM-Based
DOM-based XSS (also known as DOM XSS) arises when an application contains some client-side JavaScript that processes data from an **untrusted source** in an unsafe way, usually by writing the data back to the **DOM**.

This is often seen within a **search bar** if a message is returned such as "0 results for 'code'". This can be abused with a payload such as:
`a"><img src="x" onerror="alert(1)">`

## Execution Of JavaScript
### Via URL/Link
JavaScript can be executed via a URL when the URL starts with `javascript:`. This can be used within a `href` or `src` attribute in order to **execute** the malicious code. [List of HTML attributes with a URL value ](https://stackoverflow.com/questions/2725156/complete-list-of-html-tag-attributes-which-have-a-url-value)

### Via onEvent Attributes
JavaScript can also be executed by attributes which execute **on an event**, for example `onerror` or `onclick`. [List of HTML attributes which execute JavaScript](https://www.w3.org/TR/html401/interact/scripts.html#h-18.2.3)

## AngularJS
### AngularJS Sandbox
The **AngularJS sandbox** is a mechanism that **prevents** access to potentially dangerous objects, such as `window` or `document`, in AngularJS template expressions. It also prevents access to potentially dangerous properties, such as `__proto__`. Despite not being considered a security **boundary** by the AngularJS team, the wider developer community generally thinks otherwise. Although **bypassing** the sandbox was initially challenging, security researchers have discovered numerous ways of doing so. As a result, it was eventually removed from AngularJS in **version 1.6**. However, many legacy applications still use older versions of AngularJS and may be vulnerable as a result.

### Template String Exploit
When AngularJS is in use, **template strings** are used where JavaScript code can be placed between **curly brackets**, for example `{{code}}`

This can be used to execute in a XSS attack such as:
``{{$on.constructor('alert(1)')()}}``

[Read more](https://portswigger.net/web-security/cross-site-scripting/contexts/angularjs-sandbox)